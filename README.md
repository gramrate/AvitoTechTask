# Сервис назначения ревьюеров для Pull Request'ов

приложения для автоматического назначения ревьюеров на Pull Request'ы и управления командами.

## Быстрый старт

```bash
# Запустить сервис
docker compose up
```

Сервис будет доступен на порту `8000`.

## API Endpoints

API полностью соответствует предоставленной спецификации

## Конфигурация

### Файлы конфигурации

1. **`.env`** - основные настройки (создать из `.env.example`)

```
POSTGRES_USER=postgres
POSTGRES_PASSWORD=password
POSTGRES_DB=avito_db
SERVER_PORT=8000
```

2. **`config.yaml`** - конфигурация приложения (так же создать из .example)

## База данных

Используется PostgreSQL с автоматическими миграциями через Ent.

### Схема данных

- **Users** - пользователи с флагом активности
- **Teams** - команды разработчиков
- **PullRequests** - PR с авторами и ревьюверами

## Особенности реализации

- Автоматическое назначение до 2 случайных ревьюверов из команды автора
- Переназначение ревьюверов из команды заменяемого пользователя
- Валидация бизнес-правил (нельзя менять мерженые PR и т.д.)
- Обработка ошибок с кастомными кодами
- Транзакционность критических операций

## Проблемы и решения

Тут будет открытый диалог с разработчиком этого задания и openapi

Первое, что я хочу заметить - в спецификации задаются айди пользователей. Зачем это? это мимо принципов, рушится
безопасность приложения, и это как минимум неудобно.

Второе - В разных ручках одной группы разные сигнатуры структур

```json
{
  "user": {
    "username": "..."
  }
}
```

```json
{
  "username": "..."
}
```

Это из ваших файлов. то мы делаем юзера как доп объект, то суем его полностью в дто. Очень сложно становиться писать
код, интуитивно неясно что от меня в конкретный момент ждут.

### Теперь мои решения

Я начну с идентификации - в спеке не сказано какие именно id надо было использовать - я взял uuid v4, на данный момент
одна из лучших реализаций айди в моем понимании.

Следующее - бд. Я решил воспользоваться ent-go, и сгенерировать все методы для работы с базой данных. Это очень удобно и
сильно ускоряет разработку.

Потом - я решил немного расширить стандартную спецификацию, и в поле для получения PR, где пользователь стоит на ревью,
добавил поле status (open/merged), для фильтрации

Так же вы предоставили мне свою структуру ошибки, и свою систему кодов. Enum был приложен, но я посчитал, что там не
хватило полей, и добавил несколько своих - вы можете посмотреть в internal/domain/types/codes.go

Вроде все сказал. Я долго работал над архитектурой, в частности поэтому не успел реализовать все функции. но надо
понимать, что могу я гораздо больше, чем есть тут, можете на моем гх глянуть организации

```